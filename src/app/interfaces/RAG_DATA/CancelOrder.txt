# Cancel Order API

## Endpoint Information
- **Method:** DELETE
- **URL:** https://api.finam.ru/v1/accounts/{account_id}/orders/{order_id}
- **Description:** Отмена биржевой заявки

## Request Parameters
- **account_id** (string): Идентификатор аккаунта (номер счета)
- **order_id** (string): Идентификатор заявки для отмены

## Request Headers
- **Authorization:** JWT-токен (обязательно)

## Response Parameters

### Order Information
- **order_id** (string): Идентификатор заявки
- **exec_id** (string): Идентификатор исполнения
- **status** (OrderStatus): Статус заявки (обычно ORDER_STATUS_CANCELED)
- **order** (Order): Детали заявки
- **transact_at** (string): Дата и время выставления заявки
- **accept_at** (string): Дата и время принятия заявки
- **withdraw_at** (string): Дата и время отмены заявки

### Order Object Structure
- **account_id** (string): Идентификатор аккаунта
- **symbol** (string): Символ инструмента
- **quantity** (object): Количество в штуках
  - **value** (string): Количество
- **side** (grpc.tradeapi.v1.Side): Сторона заявки
- **type** (OrderType): Тип заявки
- **time_in_force** (TimeInForce): Срок действия
- **limit_price** (object, optional): Лимитная цена
  - **value** (string): Цена
- **stop_price** (object, optional): Стоп-цена
  - **value** (string): Цена
- **stop_condition** (StopCondition): Условие срабатывания
- **legs** (Leg Array): Мульти-леговые заявки
- **client_order_id** (string): Клиентский ID заявки
- **valid_before** (ValidBefore): Срок действия
- **comment** (string): Комментарий

## Example Response
```json
{
  "order_id": "71218896129",
  "exec_id": "ord.71218896129.1759374649627058",
  "status": "ORDER_STATUS_CANCELED",
  "order": {
    "account_id": "1899011",
    "symbol": "AFLT@MISX",
    "quantity": {
      "value": "10.0"
    },
    "side": "SIDE_BUY",
    "type": "ORDER_TYPE_LIMIT",
    "time_in_force": "TIME_IN_FORCE_DAY",
    "limit_price": {
      "value": "50.0"
    },
    "stop_condition": "STOP_CONDITION_UNSPECIFIED",
    "legs": [],
    "client_order_id": "01K6JHX3R11GNGN88TP6A411B0",
    "valid_before": "VALID_BEFORE_UNSPECIFIED"
  },
  "transact_at": "2025-10-02T13:33:56.188Z"
}
```

## Key Concepts

### Order Cancellation
- **order_id**: Уникальный идентификатор заявки для отмены
- **account_id**: Аккаунт, которому принадлежит заявка
- **status**: После отмены статус становится ORDER_STATUS_CANCELED

### Cancellation Rules
- Можно отменить только активные заявки
- Нельзя отменить уже исполненные заявки
- Нельзя отменить уже отмененные заявки
- Отмена происходит немедленно

### Order Status After Cancellation
- **ORDER_STATUS_CANCELED**: Заявка успешно отменена
- **ORDER_STATUS_REJECTED**: Заявка отклонена (если отмена невозможна)

## Usage Examples

### Basic Cancellation
```python
# Отмена заявки по order_id
order_id = "71218896129"
account_id = "1899011"

response = requests.delete(
    f"https://api.finam.ru/v1/accounts/{account_id}/orders/{order_id}",
    headers={"Authorization": jwt_token}
)

result = response.json()
print(f"Статус отмены: {result['status']}")
```

## Order Status Values
- **ORDER_STATUS_CANCELED**: Заявка отменена
- **ORDER_STATUS_REJECTED**: Заявка отклонена (при попытке отмены)
- **ORDER_STATUS_FILLED**: Заявка уже исполнена (нельзя отменить)
- **ORDER_STATUS_NEW**: Заявка новая (можно отменить)

## Usage Notes
- Обязательно передавать JWT-токен в заголовке Authorization
- account_id берется из ответа TokenDetails
- order_id получается при создании заявки через PlaceOrder
- Можно отменить только активные заявки (NEW, PARTIALLY_FILLED)
- Нельзя отменить уже исполненные или отмененные заявки
- Отмена происходит немедленно после запроса
- Рекомендуется проверять статус заявки перед попыткой отмены
- Используйте GetOrders для получения списка активных заявок
